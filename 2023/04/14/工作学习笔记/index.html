<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="LInux服务器命令1234#连接另一台Linux服务器，示例1ssh -l 主机名 IP或者ssh 用户名@服务器地址  maven项目引入外部jar包1234567891011121314151.pom文件引入该jar包    &lt;dependency&gt;    &lt;groupId&gt;com.sfjar&lt;&#x2F;groupId&gt;    &lt;artifactId&gt;">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2023/04/14/%E5%B7%A5%E4%BD%9C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="LInux服务器命令1234#连接另一台Linux服务器，示例1ssh -l 主机名 IP或者ssh 用户名@服务器地址  maven项目引入外部jar包1234567891011121314151.pom文件引入该jar包    &lt;dependency&gt;    &lt;groupId&gt;com.sfjar&lt;&#x2F;groupId&gt;    &lt;artifactId&gt;">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-04-14T07:38:25.073Z">
<meta property="article:modified_time" content="2023-04-14T03:54:51.762Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-工作学习笔记" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/04/14/%E5%B7%A5%E4%BD%9C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="article-date">
  <time class="dt-published" datetime="2023-04-14T07:38:25.073Z" itemprop="datePublished">2023-04-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="LInux服务器命令"><a href="#LInux服务器命令" class="headerlink" title="LInux服务器命令"></a>LInux服务器命令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">连接另一台Linux服务器，示例1</span></span><br><span class="line">ssh -l 主机名 IP</span><br><span class="line">或者</span><br><span class="line">ssh 用户名@服务器地址</span><br></pre></td></tr></table></figure>

<h4 id="maven项目引入外部jar包"><a href="#maven项目引入外部jar包" class="headerlink" title="maven项目引入外部jar包"></a>maven项目引入外部jar包</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>pom文件引入该jar包</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.sfjar&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;sf-csim-express-sdk&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">1.0</span>&lt;/version&gt;</span><br><span class="line">    &lt;scope&gt;system&lt;/scope&gt; 		&lt;systemPath&gt;$&#123;project.basedir&#125;/src/main/resources/jar/XXXX.jar&lt;/systemPath&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"><span class="number">2.</span>加入如下配置，在项目打包时加入该jar包，否则报ClassNotFound</span><br><span class="line">    &lt;plugin&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">    &lt;configuration&gt;</span><br><span class="line">        &lt;includeSystemScope&gt;<span class="literal">true</span>&lt;/includeSystemScope&gt;</span><br><span class="line">    &lt;/configuration&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br></pre></td></tr></table></figure>

<h4 id="docker常用命令"><a href="#docker常用命令" class="headerlink" title="docker常用命令"></a>docker常用命令</h4><h6 id="docker基础命令"><a href="#docker基础命令" class="headerlink" title="docker基础命令"></a>docker基础命令</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动docker</span></span><br><span class="line">systemctl start docker</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">关闭docker</span></span><br><span class="line">systemctl stop docker</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">重启docker</span></span><br><span class="line">systemctl restart docker</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">docker设置随服务启动而启动</span></span><br><span class="line">systemctl enable docker</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看docker运行状态</span></span><br><span class="line">systemctl status docker</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看docker版本信息</span></span><br><span class="line">docker version</span><br><span class="line">docker info</span><br></pre></td></tr></table></figure>

<h6 id="镜像相关命令"><a href="#镜像相关命令" class="headerlink" title="镜像相关命令"></a>镜像相关命令</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看镜像列表</span></span><br><span class="line">docker images</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">搜索镜像</span></span><br><span class="line">docker search XXX</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">拉取镜像</span></span><br><span class="line">docker pull XXX</span><br><span class="line">docker pull XXX:tag</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">删除镜像</span></span><br><span class="line">docker rmi -f 镜像名/镜像ID</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">保存镜像</span></span><br><span class="line">docker save 镜像名/镜像ID -o 镜像保存位置与名字</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">加载镜像</span></span><br><span class="line">docker load -i 镜像保存文件位置</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">运行镜像</span></span><br><span class="line">docker run XXX</span><br><span class="line">docker run XXX:Tag</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">镜像标签</span></span><br><span class="line">docker tag 源镜像名:tag 新镜像名:tag</span><br></pre></td></tr></table></figure>

<h6 id="容器相关命令"><a href="#容器相关命令" class="headerlink" title="容器相关命令"></a>容器相关命令</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看正在运行容器列表</span></span><br><span class="line">docker ps</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看所有容器列表</span></span><br><span class="line">docker ps -a</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">创建容器</span></span><br><span class="line">docker run -it -d --name 别名 -p 宿主机端口:容器端口 -v 宿主机文件存储位置:容器内文件位置 镜像名:Tage /bin/bash</span><br><span class="line"><span class="meta prompt_">	#</span><span class="language-bash">-it 表示 与容器进行交互式启动</span></span><br><span class="line"><span class="meta prompt_">	#</span><span class="language-bash">-d 表示可后台运行容器 （守护式运行）</span>  </span><br><span class="line"><span class="meta prompt_">	#</span><span class="language-bash">--name 给要运行的容器 起的名字</span>  </span><br><span class="line"><span class="meta prompt_">	#</span><span class="language-bash">/bin/bash  交互路径</span></span><br><span class="line"><span class="meta prompt_">	#</span><span class="language-bash">-p 将容器的端口映射到宿主机上，通过宿主机访问内部端口</span></span><br><span class="line"><span class="meta prompt_">	#</span><span class="language-bash">-v 将容器内的指定文件夹挂载到宿主机对应位置</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">停止容器</span></span><br><span class="line">docker stop 容器名/容器ID</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">删除一个容器</span></span><br><span class="line">docker rm -f 容器名/容器ID </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">删除多个容器 空格隔开要删除的容器名或容器ID</span></span><br><span class="line">docker rm -f 容器名/容器ID 容器名/容器ID</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">删除全部容器</span></span><br><span class="line">docker rm -f #(docker ps -aq)</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">进入容器方式一</span></span><br><span class="line">docker exec -it 容器名/容器ID /bin/bash</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">进入容器方式二</span></span><br><span class="line">docker attach 容器名/容器ID</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">从容器内直接退出，未添加-d(持久化运行容器)时，执行此参数，容器会关闭</span></span><br><span class="line">exit</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">从容器内优雅退出</span></span><br><span class="line">Ctrl+p+q</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">重启容器</span></span><br><span class="line">docker restart 容器名/容器ID</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动容器</span></span><br><span class="line">docker start 容器名/容器ID</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">容器文件拷贝：从容器内拷出</span></span><br><span class="line">docker cp 容器名/容器ID:容器内路径 容器外路径</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">容器文件拷贝：从外部拷贝文件到容器内</span></span><br><span class="line">docker cp 容器外路径 容器名/容器ID:容器内路径</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看文件日志</span></span><br><span class="line">docker logs -f --tail=要查看末尾多少行 容器ID</span><br></pre></td></tr></table></figure>

<h6 id="docker运维命令"><a href="#docker运维命令" class="headerlink" title="docker运维命令"></a>docker运维命令</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看docker工作目录</span></span><br><span class="line">docker info |grep &quot;Docker Root Dir&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看docker磁盘占用总体情况</span></span><br><span class="line">du -hs /var/lib/docker/</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看docker的磁盘使用情况</span></span><br><span class="line">docker system df</span><br></pre></td></tr></table></figure>

<h4 id="docker上创建主从数据库"><a href="#docker上创建主从数据库" class="headerlink" title="docker上创建主从数据库"></a>docker上创建主从数据库</h4><h6 id="新建主服务器容器"><a href="#新建主服务器容器" class="headerlink" title="新建主服务器容器"></a>新建主服务器容器</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 3303:3306 </span><br><span class="line">    --privileged=true </span><br><span class="line">    -v /data/mysql-master/log:/var/log/mysql </span><br><span class="line">    -v /data/mysql-master/data:/var/lib/mysql </span><br><span class="line">    -v /data/mysql-master/conf:/etc/mysql </span><br><span class="line">    -e MYSQL_ROOT_PASSWORD=root </span><br><span class="line">    --name mysql-master mysql:5.7.34</span><br></pre></td></tr></table></figure>

<h6 id="conf下创建配置文件my-cnf"><a href="#conf下创建配置文件my-cnf" class="headerlink" title="conf下创建配置文件my.cnf"></a>conf下创建配置文件my.cnf</h6><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line"><span class="params">##</span> 设置server<span class="built_in">_</span>id，同一局域网中需要唯一</span><br><span class="line">server<span class="built_in">_</span>id=101</span><br><span class="line"><span class="params">##</span> 指定不需要同步的数据库名称</span><br><span class="line">binlog-ignore-db=mysql</span><br><span class="line"><span class="params">##</span> 开启二进制日志功能</span><br><span class="line">log-bin=mall-mysql-bin</span><br><span class="line"><span class="params">##</span> 设置二进制日志使用内存大小（事务）</span><br><span class="line">binlog<span class="built_in">_</span>cache<span class="built_in">_</span>size=1M</span><br><span class="line"><span class="params">##</span> 设置使用的二进制日志格式（mixed,statement,row）</span><br><span class="line">binlog<span class="built_in">_</span>format=mixed</span><br><span class="line"><span class="params">##</span> 二进制日志过期清理时间。默认值为0，表示不自动清理。</span><br><span class="line">expire<span class="built_in">_</span>logs<span class="built_in">_</span>days=7</span><br><span class="line"><span class="params">##</span> 跳过主从复制中遇到的所有错误或指定类型的错误，避免slave端复制中断。</span><br><span class="line"><span class="params">##</span> 如：1062错误是指一些主键重复，1032错误是因为主从数据库数据不一致</span><br><span class="line">slave<span class="built_in">_</span>skip<span class="built_in">_</span>errors=1062</span><br><span class="line"><span class="params">#</span>设置字符编码</span><br><span class="line">collation<span class="built_in">_</span>server = utf8<span class="built_in">_</span>general<span class="built_in">_</span>ci</span><br><span class="line">character<span class="built_in">_</span>set<span class="built_in">_</span>server = utf8</span><br><span class="line">[client]</span><br><span class="line">default<span class="built_in">_</span>character<span class="built_in">_</span>set=utf8</span><br></pre></td></tr></table></figure>

<h6 id="主数据库操作"><a href="#主数据库操作" class="headerlink" title="主数据库操作"></a>主数据库操作</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">重启主数据库</span></span><br><span class="line">docker restart 容器ID</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">进入容器</span></span><br><span class="line">docker exec -it mysql-master /bin/bash</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">登录数据库</span></span><br><span class="line">mysql -uroot -proot</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">创建同步数据用户</span></span><br><span class="line">create user &#x27;slave&#x27;@&#x27;%&#x27; identified by &#x27;123456&#x27;;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">授予权限</span></span><br><span class="line">grant replication salve,replication client on *.* to &#x27;slave&#x27;@&#x27;%&#x27;;</span><br></pre></td></tr></table></figure>

<h6 id="从数据库操作"><a href="#从数据库操作" class="headerlink" title="从数据库操作"></a>从数据库操作</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">新建从容器，端口号修改为3304，步骤与主容器一致（注意：server-id须修改为不一致）</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">在主容器查看主从同步状态</span></span><br><span class="line">show master status;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">登录从容器</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">在从数据库配置主从配置</span></span><br><span class="line">change master to </span><br><span class="line">    master_host=&#x27;宿主机ip&#x27;, </span><br><span class="line">    master_user=&#x27;slave&#x27;, </span><br><span class="line">    master_password=&#x27;123456&#x27;, </span><br><span class="line">    master_port=3303, </span><br><span class="line">    master_log_file=&#x27;mall-mysql-bin.000001&#x27;, </span><br><span class="line">    master_log_pos=617, </span><br><span class="line">    master_connect_retry=30;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">参数说明：</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">master_host和master_post都是主数据库的</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">master_user和master_password都是主数据库创建的用户</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">master_log_file和master_log_pos是主数据库查询到的信息</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">master_connect_retry是连接重试的间隔时间，单位为秒</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">在从数据库中开启主从同步状态</span></span><br><span class="line">start slave;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">在从数据库查看主从同步状态</span></span><br><span class="line">show slave status \G;</span><br></pre></td></tr></table></figure>

<h4 id="双主双从配置"><a href="#双主双从配置" class="headerlink" title="双主双从配置"></a>双主双从配置</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">master1操作，指向master2</span></span><br><span class="line">CHANGE MASTER TO MASTER_HOST=&#x27;IP&#x27;,</span><br><span class="line">    MASTER_USER=&#x27;slave2&#x27;,</span><br><span class="line">    MASTER_PASSWORD=&#x27;123456&#x27;,</span><br><span class="line">    MASTER_LOG_FILE=&#x27;mysql-bin.000005&#x27;,</span><br><span class="line">    MASTER_LOG_POS=1001,</span><br><span class="line">    MASTER_PORT=3307;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">master2操作，指向master1</span></span><br><span class="line">CHANGE MASTER TO MASTER_HOST=&#x27;IP&#x27;,</span><br><span class="line">    MASTER_USER=&#x27;slave1&#x27;,</span><br><span class="line">    MASTER_PASSWORD=&#x27;123456&#x27;,</span><br><span class="line">    MASTER_LOG_FILE=&#x27;mysql-bin.000066&#x27;,</span><br><span class="line">    MASTER_LOG_POS=1001;</span><br><span class="line">    </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">my.cnf增加如下配置</span></span><br><span class="line">auto_increment_increment=2  #主键递增的步长【由于数双主，如果是自动递增的主键的话，会出现主键冲突的问题】</span><br><span class="line">auto_increment_offset=1     #主键自动递增的初始值【双主的起始值设置的时候需要错开】</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">在从库作为其他从库的主库的时候，log-slave-updates必须添加，该参数作用是为了让从库从主库赋值数据时可以写入到binlog日志</span></span><br><span class="line">log-slave-updates           #双主的实例从对方实例中同步过来的数据进行二进制日志文件记录，这样才能让从节点进行同步</span><br></pre></td></tr></table></figure>

<p>注意：可能需重新配置从数据库</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">重新查询主数据库状态</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">重启从数据库主从配置</span></span><br><span class="line">stop slave;</span><br><span class="line">start slave;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">若出现Last_SQL_Error，原因：删除了主库中从库没有的数据库，执行以下命令：</span></span><br><span class="line">set GLOBAL SQL_SLAVE_SKIP_COUNTER=1;</span><br></pre></td></tr></table></figure>

<p>Mycat查表报错：1064- find no Route:SELECT * FROM ego^. test’ LIMIT 0, 1000</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">将schema.xml的 checkSQLschema=“false”,改为true</span><br><span class="line">&lt;schema name=&quot;ego&quot; **checkSQLschema=&quot;true&quot;** sqlMaxLimit=&quot;100&quot;&gt;</span><br></pre></td></tr></table></figure>

<h4 id="JDK1-8新特性"><a href="#JDK1-8新特性" class="headerlink" title="JDK1.8新特性"></a>JDK1.8新特性</h4><h6 id="函数式接口"><a href="#函数式接口" class="headerlink" title="函数式接口"></a>函数式接口</h6><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注解：@FunctionalInterface: 代表该接口为一个函数式接口，该接口只能有一个抽象方法，但排除接口默认方法以及声明中覆盖Object的公开方法</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>函数式接口</th>
<th>参数类型</th>
<th>返回类型</th>
<th>用途</th>
</tr>
</thead>
<tbody><tr>
<td>Supplier<T> 供给型</td>
<td>无</td>
<td>T</td>
<td>返回类型为T的对象，方法get()</td>
</tr>
<tr>
<td>Consumer<T> 消费型</td>
<td>T</td>
<td>void</td>
<td>对类型为T的对象应用操作，方法：void accept(T t)</td>
</tr>
<tr>
<td>Predicate<T> 断定型</td>
<td>T</td>
<td>boolean</td>
<td>确定类型为T的对象是否满足某种约束，返回布尔值，方法： boolean test(T t)</td>
</tr>
<tr>
<td>Function&lt;T,R&gt; 函数型</td>
<td>T</td>
<td>R</td>
<td>对类型为T的对象应用操作，并返回R类型的对象，方法： R apply(T t)</td>
</tr>
</tbody></table>
<h6 id="方法引用"><a href="#方法引用" class="headerlink" title="方法引用"></a>方法引用</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 通过对象名引用成员方法</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">Supplier&lt;String&gt; supplier = () -&gt; person.getName();</span><br><span class="line">Supplier&lt;Integer&gt; supplier1 = Person::getAge;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 通过类名称引用静态方法</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">Comparator&lt;Integer&gt; comparator = (x,y) -&gt; Integer.compare(x,y);</span><br><span class="line">Comparator&lt;Integer&gt; comparator1 = Integer::compare;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 通过类名引用实例方法</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">BiPredicate&lt;String,String&gt; biPredicate = (x,y) -&gt; x.equals(y);</span><br><span class="line">BiPredicate&lt;String,String&gt; biPredicate1 = String::equals;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 通过super引用成员方法</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">() -&gt; <span class="built_in">super</span>.hello() =&gt; <span class="built_in">super</span>::hello;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 通过this引用成员方法</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">() -&gt; <span class="built_in">this</span>.buyCar() =&gt; <span class="built_in">this</span>::buyCar;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 类的构造器引用</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">Function&lt;Integer,Integer&gt; personFunction = (x) -&gt; <span class="keyword">new</span> <span class="title class_">Person</span>(x);</span><br><span class="line">Funution&lt;Integer,Integer&gt; personFunction1 = Person::<span class="keyword">new</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 数组的构造器引用</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">Function&lt;Integer,String[]&gt; function = (x) -&gt; <span class="keyword">new</span> <span class="title class_">String</span>[x];</span><br><span class="line">Function&lt;Integer,String[]&gt; function1 = String[]::<span class="keyword">new</span>;</span><br></pre></td></tr></table></figure>

<h6 id="Stream流"><a href="#Stream流" class="headerlink" title="Stream流"></a>Stream流</h6><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">创建Stream流三个步骤：</span><br><span class="line">	创建stream： 一个数据源（集合、数组），获取一个流</span><br><span class="line">	中间操作： 一个操作链，对数据源的数据进行操作</span><br><span class="line">	终止操作： 一个终止操作，执行中间操作链并产生结果</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 获取流</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="comment">//根据Collection获取流</span></span><br><span class="line">Stream&lt;String&gt; stream1 = list.stream();</span><br><span class="line">Stream&lt;String&gt; stream2 = set.stream();</span><br><span class="line">Stream&lt;String&gt; stream3 = vector.stream();</span><br><span class="line"><span class="comment">//根据map获取流</span></span><br><span class="line">Stream&lt;String&gt; stream4 = map.keySet().stream();</span><br><span class="line">Stream&lt;String&gt; stream5 = map.values().stream();</span><br><span class="line"><span class="comment">//根据数组获取流</span></span><br><span class="line">Stream&lt;String&gt; stream6 = Stream.of(array);</span><br><span class="line"><span class="comment">//获取无限流</span></span><br><span class="line">Stream&lt;String&gt; stream7 = Stream.generate(() -&gt; Math.random());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 常用方法</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="comment">//延迟方法：支持链式调用</span></span><br><span class="line"><span class="comment">//终结方法：包括foreach和count</span></span><br><span class="line"><span class="comment">//逐一处理</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">foreach</span><span class="params">(Consumer&lt;? <span class="built_in">super</span> T&gt; action)</span>;</span><br><span class="line"><span class="comment">//过滤</span></span><br><span class="line">Stream&lt;T&gt; <span class="title function_">filter</span><span class="params">(Predicate&lt;? <span class="built_in">super</span> T&gt; predicate)</span>;</span><br><span class="line"><span class="comment">//映射：即将流中的元素映射到另一个流中</span></span><br><span class="line">&lt;R&gt; Stream&lt;R&gt; <span class="title function_">map</span><span class="params">(Function&lt;? <span class="built_in">super</span> T,? extends R&gt; mapper)</span>;</span><br><span class="line"><span class="comment">//flatmap：将流中的每个值都换成另一个流，然后把所有的流连接成一个流</span></span><br><span class="line">Stream&lt;Character&gt; characterStream = list.stream().flatMap(XX::xx);</span><br><span class="line"><span class="comment">//规约reduce：将流中元素反复结合起来，得到一个值</span></span><br><span class="line"><span class="comment">//统计个数count</span></span><br><span class="line"><span class="comment">//取用前几个limit</span></span><br><span class="line"><span class="comment">//跳过前几个skip</span></span><br><span class="line"><span class="comment">//组合concat：将两个流合并成一个流</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 排序sorted：</span></span><br><span class="line"><span class="comment">  * sorted()自然排序；</span></span><br><span class="line"><span class="comment">  * sorted(Comparator com)定制排序；</span></span><br><span class="line"><span class="comment">  * allMatch 检查是否匹配所有元素</span></span><br><span class="line"><span class="comment">  * anyMatch 检查是否至少匹配一个元素</span></span><br><span class="line"><span class="comment">  * noneMatch 检查是否没有匹配所有元素</span></span><br><span class="line"><span class="comment">  * findFirst 返回第一个元素</span></span><br><span class="line"><span class="comment">  * findAny 返回当前流中的任意元素</span></span><br><span class="line"><span class="comment">  * count 返回流中元素的总个数</span></span><br><span class="line"><span class="comment">  * max 返回流中的最大值</span></span><br><span class="line"><span class="comment">  * min 返回流中的最小值</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="comment">//Collect：将流转化为其他形式，接受一个Collector的实现，用于给stream中的元素做汇总的方法</span></span><br></pre></td></tr></table></figure>

<h4 id="K8S"><a href="#K8S" class="headerlink" title="K8S"></a>K8S</h4><h6 id="jenkinsfile后端文件"><a href="#jenkinsfile后端文件" class="headerlink" title="jenkinsfile后端文件"></a>jenkinsfile后端文件</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">  agent &#123;</span><br><span class="line">    node &#123;</span><br><span class="line">      label &#x27;maven&#x27;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  stages &#123;</span><br><span class="line"><span class="meta prompt_">   #</span><span class="language-bash">拉取代码</span></span><br><span class="line">    stage(&#x27;clone code&#x27;) &#123;</span><br><span class="line">      agent none</span><br><span class="line">      steps &#123;</span><br><span class="line">        sh &#x27;git config --global http.sslVerify false&#x27;</span><br><span class="line">        container(&#x27;maven&#x27;) &#123;</span><br><span class="line">          git(credentialsId: &#x27;gitlab-zhoukaiwei&#x27;, branch: &#x27;main&#x27;, url: &#x27;https://git.enfi.com.cn/zhong-gui-gao-ke/enfi-security-cloud.git&#x27;, changelog: true, poll: false)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta prompt_">	#</span><span class="language-bash">编译&amp;推送</span></span><br><span class="line">    stage(&#x27;build &amp; push&#x27;) &#123;</span><br><span class="line">      agent &#123;</span><br><span class="line">        none &#123;</span><br><span class="line">          label &#x27;base&#x27;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">      steps &#123;</span><br><span class="line">        container(&#x27;maven&#x27;) &#123;</span><br><span class="line">          sh &#x27;mvn clean package -P dev  -Dmaven.test.skip=true&#x27;</span><br><span class="line">          sh &#x27;docker build -f ./Dockerfile -t $REGISTRY/$DOCKERHUB_NAMESPACE/$APP_NAME:SNAPSHOT-$BUILD_NUMBER .&#x27;</span><br><span class="line">          withCredentials([usernamePassword(credentialsId : &#x27;harbor-robot&#x27; ,passwordVariable : &#x27;DOCKER_PASSWORD&#x27; ,usernameVariable : &#x27;DOCKER_USERNAME&#x27; ,)]) &#123;</span><br><span class="line">            sh &#x27;echo &quot;$DOCKER_PASSWORD&quot; | docker login $REGISTRY -u &quot;$DOCKER_USERNAME&quot; --password-stdin&#x27;</span><br><span class="line">            sh &#x27;docker push  $REGISTRY/$DOCKERHUB_NAMESPACE/$APP_NAME:SNAPSHOT-$BUILD_NUMBER&#x27;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    stage(&#x27;push latest&#x27;) &#123;</span><br><span class="line">      agent none</span><br><span class="line">      when &#123;</span><br><span class="line">        branch &#x27;main&#x27;</span><br><span class="line">      &#125;</span><br><span class="line">      steps &#123;</span><br><span class="line">        container(&#x27;maven&#x27;) &#123;</span><br><span class="line">          sh &#x27;docker tag  $REGISTRY/$DOCKERHUB_NAMESPACE/$APP_NAME:SNAPSHOT-$BUILD_NUMBER $REGISTRY/$DOCKERHUB_NAMESPACE/$APP_NAME:latest &#x27;</span><br><span class="line">          sh &#x27;docker push  $REGISTRY/$DOCKERHUB_NAMESPACE/$APP_NAME:latest &#x27;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta prompt_">	#</span><span class="language-bash">发布</span></span><br><span class="line">    stage(&#x27;deploy to dev&#x27;) &#123;</span><br><span class="line">      agent none</span><br><span class="line">      steps &#123;</span><br><span class="line">        container(&#x27;maven&#x27;) &#123;</span><br><span class="line">          withCredentials([</span><br><span class="line">                        kubeconfigFile(</span><br><span class="line">                          credentialsId: env.KUBECONFIG_CREDENTIAL_ID,</span><br><span class="line">                          variable: &#x27;KUBECONFIG&#x27;)</span><br><span class="line">                          ]) &#123;</span><br><span class="line">                sh &#x27;envsubst &lt; deploy/deploy.yml | kubectl apply -f -&#x27;</span><br><span class="line">              &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">      #环境配置</span><br><span class="line">      environment &#123;</span><br><span class="line">        DOCKER_CREDENTIAL_ID = &#x27;harbor-robot&#x27;</span><br><span class="line">        GITHUB_CREDENTIAL_ID = &#x27;github-id&#x27;</span><br><span class="line">        KUBECONFIG_CREDENTIAL_ID = &#x27;kubesphere-config&#x27;</span><br><span class="line">        REGISTRY = &#x27;openapi.enfi.com.cn:30012&#x27;</span><br><span class="line">        DOCKERHUB_NAMESPACE = &#x27;op-zhonggui&#x27;</span><br><span class="line">        GITHUB_ACCOUNT = &#x27;kubesphere&#x27;</span><br><span class="line">        APP_NAME = &#x27;enfi-security&#x27;</span><br><span class="line">        NAMESPACE = &#x27;mes-zhonggui&#x27;</span><br><span class="line">        PORT = &#x27;9301&#x27;</span><br><span class="line">        NODEPORT = &#x27;31151&#x27;</span><br><span class="line">        BRANCH_NAME = &#x27;master(分支)&#x27;</span><br><span class="line">      &#125;</span><br><span class="line">      parameters &#123;</span><br><span class="line">        string(name: &#x27;TAG_NAME&#x27;, defaultValue: &#x27;main&#x27;, description: &#x27;main&#x27;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h6 id="jenkinsfile前端文件"><a href="#jenkinsfile前端文件" class="headerlink" title="jenkinsfile前端文件"></a>jenkinsfile前端文件</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">  agent &#123;</span><br><span class="line">    node &#123;</span><br><span class="line">      label &#x27;nodejs&#x27;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  stages &#123;</span><br><span class="line">    stage(&#x27;拉取代码&#x27;) &#123;</span><br><span class="line">      agent none</span><br><span class="line">      steps &#123;</span><br><span class="line">        sh &#x27;git config --global http.sslVerify false&#x27;</span><br><span class="line">        container(&#x27;nodejs&#x27;) &#123;</span><br><span class="line">          git(url: &#x27;https://git.enfi.com.cn/zhong-gui-gao-ke/enfi-securitynew-front.git&#x27;, credentialsId: &#x27;gitlab-zhoukaiwei&#x27;, branch: &#x27;main&#x27;, changelog: true, poll: false)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    stage(&#x27;项目编译&#x27;) &#123;</span><br><span class="line">      agent none</span><br><span class="line">      steps &#123;</span><br><span class="line">        container(&#x27;nodejs&#x27;) &#123;</span><br><span class="line">          sh &#x27;npm install&#x27;</span><br><span class="line">        //  sh &#x27;npm install npm@10.23.3&#x27;</span><br><span class="line">          sh &#x27;npm run build&#x27;</span><br><span class="line">          sh &#x27;ls -l&#x27;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    stage(&#x27;构建镜像&#x27;) &#123;</span><br><span class="line">      agent none</span><br><span class="line">      steps &#123;</span><br><span class="line">        container(&#x27;nodejs&#x27;) &#123;</span><br><span class="line">          sh &#x27;docker build -f deploy/Dockerfile -t $REGISTRY/$DOCKERHUB_NAMESPACE/$APP_NAME:SNAPSHOT-$BUILD_NUMBER .&#x27;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    stage(&#x27;推送镜像&#x27;) &#123;</span><br><span class="line">      agent none</span><br><span class="line">      steps &#123;</span><br><span class="line">        container(&#x27;nodejs&#x27;) &#123;</span><br><span class="line">          withCredentials([usernamePassword(credentialsId : &#x27;harbor-robot&#x27; ,passwordVariable : &#x27;DOCKER_PASSWORD&#x27; ,usernameVariable : &#x27;DOCKER_USERNAME&#x27; ,)]) &#123;</span><br><span class="line">            sh &#x27;echo &quot;$DOCKER_PASSWORD&quot; | docker login $REGISTRY -u &quot;$DOCKER_USERNAME&quot; --password-stdin&#x27;</span><br><span class="line">            sh &#x27;docker push $REGISTRY/$DOCKERHUB_NAMESPACE/$APP_NAME:SNAPSHOT-$BUILD_NUMBER&#x27;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    stage(&#x27;部署&#x27;) &#123;</span><br><span class="line">      steps &#123;</span><br><span class="line">        container (&#x27;nodejs&#x27;) &#123;</span><br><span class="line">          withCredentials([</span><br><span class="line">            kubeconfigFile(</span><br><span class="line">            credentialsId: env.KUBECONFIG_CREDENTIAL_ID,</span><br><span class="line">            variable: &#x27;KUBECONFIG&#x27;)</span><br><span class="line">            ]) &#123;</span><br><span class="line">            sh &#x27;envsubst &lt; deploy/deploy.yml | kubectl apply -f -&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  environment &#123;</span><br><span class="line">    DOCKER_CREDENTIAL_ID = &#x27;harbor-robot&#x27;</span><br><span class="line">    GITHUB_CREDENTIAL_ID = &#x27;github-id&#x27;</span><br><span class="line">    KUBECONFIG_CREDENTIAL_ID = &#x27;kubesphere-config&#x27;</span><br><span class="line">    REGISTRY = &#x27;openapi.enfi.com.cn:30012&#x27;</span><br><span class="line">    DOCKERHUB_NAMESPACE = &#x27;op-zhonggui&#x27;</span><br><span class="line">    GITHUB_ACCOUNT = &#x27;kubesphere&#x27;</span><br><span class="line">    APP_NAME = &#x27;enfi-security-front-new&#x27;</span><br><span class="line">    NAMESPACE = &#x27;mes-zhonggui&#x27;</span><br><span class="line">    PORT = &quot;8001&quot;</span><br><span class="line">    NODEPORT = &#x27;32032&#x27;</span><br><span class="line">    BRANCH_NAME = &#x27;master(分支)&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">  parameters &#123;</span><br><span class="line">    string(name: &#x27;TAG_NAME&#x27;, defaultValue: &#x27;main&#x27;, description: &#x27;main&#x27;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Linux常用命令"><a href="#Linux常用命令" class="headerlink" title="Linux常用命令"></a>Linux常用命令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看磁盘使用情况</span></span><br><span class="line">du -h --max-depth=1</span><br></pre></td></tr></table></figure>

<h4 id="Linux安装mysql"><a href="#Linux安装mysql" class="headerlink" title="Linux安装mysql"></a>Linux安装mysql</h4><h6 id="安装mysql"><a href="#安装mysql" class="headerlink" title="安装mysql"></a>安装mysql</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看是否已经安装数据库</span></span><br><span class="line">rpm -qa | grep mysql</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">如果已安装，进行卸载</span></span><br><span class="line">rpm -e xxx</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">下载Mysql安装包：https://downloads.mysql.com/archives/community/</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装包解压，并且重命名为mysql</span></span><br><span class="line">tar -zxvf mysql-5.7.35-linux-glibc2.12-x86_64.tar.gz</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">检查是否存在mysql用户和用户组</span></span><br><span class="line">groups mysql </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">添加用户组和用户</span></span><br><span class="line">groupadd mysql &amp;&amp; useradd -r -g mysql mysql</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">创建数据目录并赋予权限</span></span><br><span class="line">mkdir -p /data/mysql</span><br><span class="line">chown mysql:mysql -R /data/mysql</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">修改配置文件 vim/etc/my.cnf</span></span><br><span class="line">[mysqld]</span><br><span class="line">bind-address=0.0.0.0</span><br><span class="line">port=3306</span><br><span class="line">user=mysql</span><br><span class="line">basedir=/usr/local/mysql</span><br><span class="line">datadir=/data/mysql</span><br><span class="line">socket=/tmp/mysql.sock</span><br><span class="line">log-error=/data/mysql/mysql.err</span><br><span class="line">pid-file=/data/mysql/mysql.pid</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">character config</span></span><br><span class="line">character_set_server=utf8mb4</span><br><span class="line">symbolic-links=0</span><br><span class="line">explicit_defaults_for_timestamp=true</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">初始化数据库，进入bin目录</span></span><br><span class="line">./mysqld --defaults-file=/etc/my.cnf --basedir=/usr/local/mysql/ --datadir=/data/mysql/ --user=mysql --initialize</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看初始密码</span></span><br><span class="line">cat /data/mysql/mysql.err</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动mysql</span></span><br><span class="line">cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysql</span><br><span class="line">service mysql start</span><br></pre></td></tr></table></figure>

<h6 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">开启免密登录，在【mysqld】模块下面添加：skip-grant-tables 保存退出</span></span><br><span class="line">vim /etc/my.cnf </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">重启mysql</span></span><br><span class="line">service mysql restart</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">登录mysql，进入bin目录</span></span><br><span class="line">./mysql -u root -p</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">刷新规则允许外部访问</span></span><br><span class="line">use mysql 　　　　 #选择访问mysql库</span><br><span class="line">update user set host = &#x27;%&#x27; where user = &#x27;root&#x27;; 　　　　 #使root能再任何host访问</span><br><span class="line">FLUSH PRIVILEGES; 　　 　　 #刷新 </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">修改密码</span></span><br><span class="line">ALTER USER &quot;root&quot;@&quot;%&quot; IDENTIFIED WITH mysql_native_password  BY &quot;root&quot;;</span><br><span class="line">FLUSH PRIVILEGES; 　　 　　 #刷新 </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">退出，删掉免密登录配置</span></span><br></pre></td></tr></table></figure>

<h6 id="用户权限"><a href="#用户权限" class="headerlink" title="用户权限"></a>用户权限</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">创建新用户</span></span><br><span class="line">CREATE USER &#x27;test&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;123&#x27;;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">&#x27;%&#x27;</span> - 所有情况都能访问</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">‘localhost’ - 本机才能访问</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">’111.222.33.44‘ - 指定 ip 才能访问</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">用户赋权</span></span><br><span class="line">grant all on 数据库名.数据库表 to 用户名@&#x27;%&#x27;  identified by &quot;密码&quot;;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">all 可以替换为 select,delete,update,create,drop</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">数据库名 所有的 用*</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">数据库表 所有的 用*</span></span><br></pre></td></tr></table></figure>

<h6 id="查看磁盘空间"><a href="#查看磁盘空间" class="headerlink" title="查看磁盘空间"></a>查看磁盘空间</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">du -ah --max-depth=1</span><br></pre></td></tr></table></figure>

<h6 id="Linux设置mysql开机启动"><a href="#Linux设置mysql开机启动" class="headerlink" title="Linux设置mysql开机启动"></a>Linux设置mysql开机启动</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">1.将安装目录下的 support-files 目录下mysql.server复制到/etc/rc.d/init.d/mysql</span></span><br><span class="line">cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysql</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">2.复制后赋予权限</span></span><br><span class="line">chmod +x /etc/init.d/mysql</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">3.添加到服务列表</span></span><br><span class="line">chkconfig --add mysql</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">4.查看服务列表</span></span><br><span class="line">chkconfig --list</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">如未设置成功，执行以下命令</span></span><br><span class="line">chkconfig --level 345 mysqld on、</span><br></pre></td></tr></table></figure>

<h6 id="mysql常见错误"><a href="#mysql常见错误" class="headerlink" title="mysql常见错误"></a>mysql常见错误</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">登录出现Access denied <span class="keyword">for</span> user <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> (using password: YES)</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">1.设置mysql为免密登录，进入后，如没有root用户，新增root用户</span></span><br><span class="line">insert into user(User,authentication_string,ssl_cipher,x509_issuer,x509_subject) values(&#x27;root&#x27;,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;);</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">2.给root用户添加权限</span></span><br><span class="line">update user set Host=&#x27;%&#x27;,select_priv=&#x27;y&#x27;, insert_priv=&#x27;y&#x27;,update_priv=&#x27;y&#x27;,Alter_priv=&#x27;y&#x27;,delete_priv=&#x27;y&#x27;,create_priv=&#x27;y&#x27;,drop_priv=&#x27;y&#x27;,reload_priv=&#x27;y&#x27;,shutdown_priv=&#x27;y&#x27;,Process_priv=&#x27;y&#x27;,file_priv=&#x27;y&#x27;,grant_priv=&#x27;y&#x27;,References_priv=&#x27;y&#x27;,index_priv=&#x27;y&#x27;,create_user_priv=&#x27;y&#x27;,show_db_priv=&#x27;y&#x27;,super_priv=&#x27;y&#x27;,create_tmp_table_priv=&#x27;y&#x27;,Lock_tables_priv=&#x27;y&#x27;,execute_priv=&#x27;y&#x27;,repl_slave_priv=&#x27;y&#x27;,repl_client_priv=&#x27;y&#x27;,create_view_priv=&#x27;y&#x27;,show_view_priv=&#x27;y&#x27;,create_routine_priv=&#x27;y&#x27;,alter_routine_priv=&#x27;y&#x27;,create_user_priv=&#x27;y&#x27; where user=&#x27;root&#x27;;commit;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">3.修改用户密码</span></span><br><span class="line">ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;我的密码&#x27;;</span><br><span class="line">flush privileges;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">4.去除免密登录配置，重启数据库</span></span><br></pre></td></tr></table></figure>

<h4 id="Linux安装git"><a href="#Linux安装git" class="headerlink" title="Linux安装git"></a>Linux安装git</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">下载地址</span></span><br><span class="line">https://git-scm.com/download/linux</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">解压压缩包</span></span><br><span class="line">tar -zxvf git.tar.gz</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装编译环境，这一步会自动安装老版本git，需手动删除：yun remove git</span></span><br><span class="line">yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel gcc perl-ExtUtils-MakeMaker</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">编译源码</span></span><br><span class="line">make prefix=/opt/git all</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装git</span></span><br><span class="line">make prefix=/opt/git install</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">配置环境变量</span></span><br><span class="line">vim /etc/profile</span><br><span class="line">增加</span><br></pre></td></tr></table></figure>

<h4 id="Linux安装redis"><a href="#Linux安装redis" class="headerlink" title="Linux安装redis"></a>Linux安装redis</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">下载redis</span></span><br><span class="line">wget http://download.redis.io/releases/redis-5.0.7.tar.gz</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">解压redis</span></span><br><span class="line">tar -zvxf redis-5.0.7.tar.gz</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">移动redis目录</span></span><br><span class="line">mv redis-5.0.7 /usr/local/redis</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">编译 <span class="built_in">cd</span> redis</span></span><br><span class="line">make</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装</span></span><br><span class="line">make PREFIX=/usr/local/redis install</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">设置后台启动，修改daemonize为<span class="built_in">yes</span></span></span><br><span class="line">vim redis.conf</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动</span></span><br><span class="line">./bin/redis-server&amp; ./redis.conf</span><br></pre></td></tr></table></figure>

<h4 id="Jenkins配置sonar"><a href="#Jenkins配置sonar" class="headerlink" title="Jenkins配置sonar"></a>Jenkins配置sonar</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sonar.projectKey=$&#123;JOB_NAME&#125;</span><br><span class="line">sonar.sources=.</span><br><span class="line">sonar.projectName=$&#123;JOB_NAME&#125;</span><br><span class="line">sonar.projectVersion=$&#123;BUILD_VERSION&#125;</span><br><span class="line"> </span><br><span class="line">sonar.language=java</span><br><span class="line">sonar.sourceEncoding=UTF-8</span><br><span class="line"> </span><br><span class="line">sonar.sources=$WORKSPACE</span><br><span class="line">sonar.java.binaries=$WORKSPACE</span><br></pre></td></tr></table></figure>

<h4 id="nginx配置"><a href="#nginx配置" class="headerlink" title="nginx配置"></a>nginx配置</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">nginx配置http转发到https接口</span></span><br><span class="line">nginx</span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  example.com;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass $request_uri;</span><br><span class="line">        proxy_redirect http:// https://;</span><br><span class="line">        proxy_set_header Host $http_host;</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Forwarded-Proto https;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">上述配置中，我们在监听端口为 80 的服务器中添加了一个名为 `/` 的 location，并使用 `proxy_pass` 将请求直接转发到 HTTPS 地址。然后，使用 `proxy_redirect` 将 HTTP 请求重定向到 HTTPS，并设置了以下三个参数：</span><br><span class="line"></span><br><span class="line">* `Host`: 设置请求头的主机名字段</span><br><span class="line">* `X-Real-IP`: 设置客户端真实 IP 地址</span><br><span class="line">* `X-Forwarded-Proto`: 指示客户端连接使用的协议是 HTTPS</span><br><span class="line"></span><br><span class="line">这些设置可以确保请求被正确转发到目标服务器并且可以维持原有的访问方式不变。</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">nginx配置路由转发</span></span><br><span class="line">location /api/&#123;</span><br><span class="line">   	proxy_set_header Host $http_host;</span><br><span class="line">   	proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">   	proxy_set_header REMOTE-HOST $remote_addr;</span><br><span class="line">   	proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">    proxy_http_version 1.1;</span><br><span class="line">    proxy_pass 目标地址</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>




      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/04/14/%E5%B7%A5%E4%BD%9C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" data-id="clgg8sf0w0000zopia7pt8str" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/04/14/%E5%B7%A5%E4%BD%9C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>